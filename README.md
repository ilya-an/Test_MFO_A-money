# Test_MFO_A-money
A three-part test assignment

Part 1
Есть два набора данных: визиты пользователей на сервис и данные по покупкам. У каждого визита есть источник, а также устройство, с которого заходил пользователь.
Обозначения в файлах:
- start_dt — дата старта визита,
- start_ts — дата и время старта визита,
- end_ts — дата окончания визита,
- uid — идентификатор пользователя,
- source_id — id источника визита,
- device — устройство,
- buy_ts — дата и время покупки,
- revenue — доход в y.e.

Необходимо определить, написать sql-запросы и визуализировать данные с помощью любого инструмента:
1)	Какая когорта пользователей (по месяцу первой покупки) принесла наибольший средний чек на пользователя, какая наименьший?
2)	Какие аномалии в трафике видите, если они есть?
3)	Какой LTV на каждую когорту пользователей (по месяцу первой покупки)?
4)	С какого source_id мы получили больший доход помесячно, учитывая, что покупку относим к id источника последнего перед покупкой визита?

https://drive.google.com/file/d/18xo8pnvR_IJuFoi64_YhrRopPku8X7t5/view?usp=drive_link

Part 2
Аналитик заходит в отчетность и видит такую картину в воронке:
https://docs.google.com/spreadsheets/d/1NZjw_lVavHA6MT_ZYfhOIkH23PplUoB-kKRrOI3B7xg/edit?usp=drive_link
Какой шаг воронки 17.09.2023 больше всего повлиял на снижение количества целевых действий (оформление договора)? Почему?

Part 3
В таблице test_tbl содержатся неповторяющиеся числа от 1 до N, при этом строк в таблице N-1, требуется вывести пропущенное число при помощи скрипта SQL. Пример таблицы при N=12.
https://drive.google.com/file/d/1aoXoZMLjDUm5WpSoZyfCOR-ia4cPtIFt/view?usp=drive_link
